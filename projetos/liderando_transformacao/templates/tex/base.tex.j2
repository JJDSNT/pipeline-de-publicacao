\documentclass[
  {{ styles.paragraph_default_font_size_pt }}pt
]{article}

\usepackage[
  margin={{ styles.document_margins_cm }}cm
]{geometry}
\usepackage{fontspec} % Para controle de fontes modernas (XeLaTeX/LuaLaTeX)
\usepackage{xcolor}
\usepackage{titlesec}
\usepackage{setspace}
\usepackage{enumitem} % Para listas
\usepackage{ragged2e} % Para \justifying (se precisar de justificação completa)
\usepackage[{{ lang }}]{babel} % Suporte a idiomas (brazil, english)

% Mapeamento de Cores
{% for name, hex in styles.colors.items() %}
\definecolor{ {{- name -}} }{HTML}{ {{- hex -}} }
{% endfor %}

% Configurações de Fontes
\setmainfont{ {{- styles.paragraph_default_font_family -}} }
\setsansfont{ {{- styles.heading_1_font_family -}} }

% Estilo de Parágrafo Padrão
\setlength{\parindent}{ {{- styles.paragraph_default_text_indent_cm -}} cm}
\linespread{ {{- styles.paragraph_default_line_height -}} }
\parskip={{ styles.paragraph_default_margin_bottom_cm }}cm plus 1pt % Adicionado "plus 1pt" para evitar badbox
\color{ {{- styles.paragraph_default_color_name -}} }

% Estilo de Título Nível 1 (Section)
\titleformat{\section}
  {\fontsize{ {{- styles.heading_1_font_size_pt -}} pt}{ {{- styles.heading_1_line_spacing_pt -}} pt}\selectfont}
  {\textbf{\color{ {{- styles.heading_1_color_name -}} }}}
  {}
  {0pt}{}
[\vspace{ {{- styles.heading_1_margin_top_cm -}} cm}] % Espaço antes
\titlespacing*{\section}{0pt}{0pt}{ {{- styles.heading_1_margin_bottom_cm -}} cm} % Espaço depois

\begin{document}

\title{ {{- content.title -}} }
\author{ {{- content.author -}} }
\maketitle

% Exemplo de Sumário e Conteúdo:
\tableofcontents

{% for section in content.sections %}
  {% if section.type == "heading_part" %}
\part{ {{- section.text -}} } % Comando para "partes" em LaTeX
  {% elif section.type == "heading_1" %}
\section{ {{- section.text -}} } % Títulos de capítulo/seção
  {% endif %}
  
  {% set current_list_type = none %}
  {% for item in section.content %}
    {% if item.type == "paragraph_default" %}
      {% if current_list_type %}
\end{ {{- current_list_type -}} }
        {% set current_list_type = none %}
      {% endif %}
{{ item.text | trim }}
\par % Garante nova linha para cada parágrafo
    {% elif item.type == "list_item_bullet" %}
      {% if current_list_type != "itemize" %}
        {% if current_list_type %}
\end{ {{- current_list_type -}} }
        {% endif %}
\begin{itemize}
        {% set current_list_type = "itemize" %}
      {% endif %}
\item {{ item.text | trim }}
    {% elif item.type == "list_item_numbered" %}
      {% if current_list_type != "enumerate" %}
        {% if current_list_type %}
\end{ {{- current_list_type -}} }
        {% endif %}
\begin{enumerate}
        {% set current_list_type = "enumerate" %}
      {% endif %}
\item {{ item.text | trim }}
    {% endif %}
  {% endfor %}
  
  {% if current_list_type %}
\end{ {{- current_list_type -}} }
  {% endif %}
{% endfor %}

\end{document}
